<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Appointments | PetCare</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #8BC34A;
            --background-color: #f0f2f5;
            --card-background: #fff;
            --text-color: #333;
            --shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .navbar {
            background-color: var(--card-background);
            box-shadow: var(--shadow);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .navbar nav a {
            color: var(--text-color);
            text-decoration: none;
            margin-left: 1.5rem;
            transition: color 0.3s;
        }

        .navbar nav a:hover {
            color: var(--primary-color);
        }

        #logout-btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 1.5rem;
        }

        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .card {
            background-color: var(--card-background);
            border-radius: 10px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .appointment-list {
            list-style: none;
            padding: 0;
        }

        .appointment-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #eee;
        }

        .appointment-item:last-child {
            border-bottom: none;
        }
        
        /* New: Style for "No appointments" message */
        .no-appointments {
            padding: 1rem 0;
            color: #777;
            font-style: italic;
        }

        .appointment-details {
            display: flex;
            flex-direction: column;
        }

        .appointment-details .date {
            font-weight: bold;
            color: var(--primary-color);
        }

        .appointment-details .pet-name {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .status {
            font-weight: bold;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            color: white;
        }

        .status.upcoming { background-color: #3498db; }
        .status.completed { background-color: #2ecc71; }
        .status.cancelled { background-color: #e74c3c; }

        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                text-align: center;
            }

            .navbar nav {
                margin-top: 1rem;
            }

            .navbar nav a, #logout-btn {
                margin: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header class="navbar">
        <div class="logo">PetCare</div>
        <nav>
            <a href="pet-dashboard.html">Dashboard</a>
            <a href="appointments.html">Appointments</a>
            <a href="resources.html">Resources</a>
            <a href="profile.html">Profile</a>
             <a href="pet-checkup-form.html">Pet Checkup Form</a>
            <button id="logout-btn">Logout</button>
        </nav>
    </header>

    <main class="container">
        <h1>Your Appointments</h1>
        <div class="card">
            <h2>Upcoming</h2>
            <ul id="upcoming-list" class="appointment-list">
                <p class="no-appointments">Loading upcoming appointments...</p>
            </ul>
        </div>

        <div class="card">
            <h2>Past Appointments</h2>
            <ul id="past-list" class="appointment-list">
                <p class="no-appointments">Loading past appointments...</p>
            </ul>
        </div>
    </main>

    <script>
        // DOM elements for dynamic insertion
        const upcomingList = document.getElementById('upcoming-list');
        const pastList = document.getElementById('past-list');

        // Sample data initializer (Run once)
        function scheduleAppointments() {
            if (localStorage.getItem('appointments')) {
                return; // Data already exists
            }

            // --- IMPORTANT: Date format is YYYY-MM-DD for correct comparison ---
            const sampleAppointments = [
                {
                    id: 1,
                    pet: "Buddy",
                    date: "2025-10-25",
                    time: "10:00 AM",
                    reason: "Annual Check-up",
                    status: "upcoming"
                },
                {
                    id: 2,
                    pet: "Whiskers",
                    date: "2025-11-10",
                    time: "02:00 PM",
                    reason: "Nail Trim",
                    status: "upcoming"
                },
                {
                    id: 3,
                    pet: "Whiskers",
                    date: "2025-09-01",
                    time: "02:30 PM",
                    reason: "Vaccination",
                    status: "completed"
                },
                {
                    id: 4,
                    pet: "Buddy",
                    date: "2025-08-15",
                    time: "11:00 AM",
                    reason: "Teeth Cleaning",
                    status: "completed"
                },
                {
                    id: 5,
                    pet: "Buddy",
                    date: "2025-12-05",
                    time: "09:00 AM",
                    reason: "Consultation for limping",
                    status: "cancelled" // Example of cancelled
                }
            ];

            localStorage.setItem('appointments', JSON.stringify(sampleAppointments));
        }

        // Renderer function
        function renderAppointments() {
            // 1. Get today's date for comparison
            const today = new Date().toISOString().split('T')[0]; 
            
            // 2. Load all appointments
            const appointments = JSON.parse(localStorage.getItem('appointments')) || [];
            
            // 3. Separate the lists
            const upcomingAppointments = [];
            const pastAppointments = [];

            appointments.forEach(app => {
                // If the appointment date is today or in the future, it's upcoming
                if (app.date >= today && app.status !== 'completed' && app.status !== 'cancelled') {
                     // Filter out manually completed/cancelled appointments even if date is today/future
                    upcomingAppointments.push(app);
                } else {
                    // Everything else (past dates, or manually completed/cancelled items) is considered 'past' for viewing history
                    pastAppointments.push(app);
                }
            });

            // Sort upcoming by date (earliest first)
            upcomingAppointments.sort((a, b) => new Date(a.date) - new Date(b.date));
            // Sort past by date (most recent first)
            pastAppointments.sort((a, b) => new Date(b.date) - new Date(a.date));


            // 4. Function to format date for display
            function formatDate(dateStr) {
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                return new Date(dateStr).toLocaleDateString(undefined, options);
            }

            // 5. Render Upcoming List
            upcomingList.innerHTML = '';
            if (upcomingAppointments.length === 0) {
                upcomingList.innerHTML = '<p class="no-appointments">No upcoming appointments scheduled.</p>';
            } else {
                upcomingAppointments.forEach(app => {
                    const listItem = `
                        <li class="appointment-item">
                            <div class="appointment-details">
                                <span class="date">${formatDate(app.date)} - ${app.time}</span>
                                <span class="pet-name">${app.pet}</span>
                                <span>${app.reason}</span>
                            </div>
                            <span class="status upcoming">Upcoming</span>
                        </li>
                    `;
                    upcomingList.insertAdjacentHTML('beforeend', listItem);
                });
            }

            // 6. Render Past/History List
            pastList.innerHTML = '';
            if (pastAppointments.length === 0) {
                 pastList.innerHTML = '<p class="no-appointments">No past appointment history.</p>';
            } else {
                 pastAppointments.forEach(app => {
                    const statusClass = app.status; // 'completed', 'cancelled'
                    const statusText = app.status.charAt(0).toUpperCase() + app.status.slice(1); // 'Completed', 'Cancelled'

                    const listItem = `
                        <li class="appointment-item">
                            <div class="appointment-details">
                                <span class="date">${formatDate(app.date)} - ${app.time}</span>
                                <span class="pet-name">${app.pet}</span>
                                <span>${app.reason}</span>
                            </div>
                            <span class="status ${statusClass}">${statusText}</span>
                        </li>
                    `;
                    pastList.insertAdjacentHTML('beforeend', listItem);
                });
            }
        }


        document.addEventListener('DOMContentLoaded', () => {
            const logoutBtn = document.getElementById('logout-btn');
            logoutBtn.addEventListener('click', () => {
                localStorage.clear();
                window.location.href = 'index.html';
            });
            
            // 1. Initialize sample data
            scheduleAppointments();

            // 2. Render the appointments
            renderAppointments();
        });
    </script>
</body>
</html>